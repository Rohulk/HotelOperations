
Before you can start any analysis, you need to confirm that the data is accurate and reflects what you expect to see.

It is known that there are some issues with the branch table, and the data team have provided the following data description.

Write a query to return data matching this description, including identifying and cleaning all invalid values. You must match all column names and description criteria. Your output should be a DataFrame named 'clean_branch_data'.

Column Name	                   Criteria
id	               Nominal. The unique identifier of the hotel.
                   Missing values are not possible due to the database structure.

location	         Nominal. The location of the particular hotel. One of four possible values, 'EMEA', 'NA', 'LATAM' and 'APAC'.
                   Missing values should be replaced with “Unknown”.

total_rooms	       Discrete. The total number of rooms in the hotel. Must be a positive integer between 1 and 400.
                   Missing values should be replaced with the default number of rooms, 100.

staff_count	       Discrete. The number of staff employeed in the hotel service department.
                   Missing values should be replaced with the total_rooms multiplied by 1.5.

opening_date	     Discrete. The year in which the hotel opened. This can be any value between 2000 and 2023.
                   Missing values should be replaced with 2023.

target_guests	     Nominal. The primary type of guest that is expected to use the hotel. Can be one of 'Leisure' or 'Business'.
                   Missing values should be replaced with 'Leisure'.

SELECT
    id,
    COALESCE(location, 'Unknown') AS location,
    CASE
    WHEN total_rooms BETWEEN 1 AND 400 THEN total_rooms
    ELSE 100
END AS total_rooms,
CASE
    WHEN staff_count IS NOT NULL THEN staff_count
    ELSE total_rooms * 1.5
END AS staff_count,
CASE
    WHEN opening_date = '-' THEN '2023'
    WHEN opening_date BETWEEN '2000' AND '2023' THEN opening_date
    ELSE '2023'
END AS opening_date,
CASE
    WHEN target_guests IS NULL THEN 'Leisure'
    WHEN LOWER(target_guests) LIKE 'b%' THEN 'Business'
    ELSE target_guests END AS target_guests
FROM
    public.branch;
